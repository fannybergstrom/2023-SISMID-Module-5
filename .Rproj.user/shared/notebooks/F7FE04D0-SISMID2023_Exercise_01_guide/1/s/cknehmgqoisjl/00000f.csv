"0","##############################################################################"
"0","# Function of R_0 solving for tau numerically, when there is initial immune"
"0","#  R_0 - reproduction number"
"0","#  r - fraction of initially immune"
"0","#  tau - overall final size"
"0","#  Return: tau"
"0","##############################################################################"
"0","tau_overall <- function(R_0, r) {"
"0","  final_eq <- function(tau) {"
"0","    ##########################"
"0","    #    YOUR CODE HERE      "
"0","    ##########################"
"0","    # give the equation"
"0","    1 - tau - exp(-R_0 * (1 - r) * tau)"
"0","  }"
"0","  """
"0","  Note: This final size equation only gives the fraction infected among"
"0","  those who are initially susceptible."
"0","  """
"0","  result1 <- uniroot(final_eq, lower = 0, upper = 1)$root"
"0","  result2 <- uniroot(final_eq, lower = 1e-12, upper = 1, extendInt = ""yes"")$root"
"0",""
"0","  ####################################################"
"0","  # fill in here (minimum or maximum or others?)"
"0","  ####################################################"
"0","  result <- max(result1, result2)"
"0",""
"0","  """
"0","  Note: this result is the final size among initially susceptibles."
"0","  then what is the overall fraction infected?"
"0","  """
"0","  ######################################################################"
"0","  # fill in here (here we want the OVERALL fraction infected!)"
"0","  ######################################################################"
"0",""
"0","  return(result * (1 - r))"
"0","}"
